# Subscribe with Google

This application allows us to receive contribution and subscription events from Google.

## How to run

```bash
sbt run
```

This will start the Play server in devmode.

You can then check the application is running by hitting

Local: `http://localhost:9233/healthcheck`

Prod: `https://swg.theguardian.com/healthcheck`

The following env vars must be set on the environment in which the app is running:

* `APP_SECRET` - Used by Play for signing/encryption
* `SWG_CLIENT_ID` - Google credentials for our SwG app
* `SWG_CLIENT_SECRET`
* `GOOGLE_PLAY_DEVELOPER_REFRESH_TOKEN` - Used to obtain access tokens to auth with Google APIs - [see here for more info](https://developers.google.com/android-publisher/authorization)

The application has a POST endpoint that receives JSON from the Google Cloud PubSub queue.

This can be tested by : `TODO: curl command with some sample json`




---

### Style, coverage, warnings

This application ships with sbt plugins: scalastyle, scapegoat, scoverage.

We aim to be warning free, warts free and sustain a high level of branch coverage.
Although we don't strive to have a *high* test coverage, we use the reports to identify areas of untested code.

Reports can be generated by running the command

```bash
sbt scalastyle scapegoat coverge test coverageReport
```


Coverage report location: `<repo-home>/target/scala-2.12/scoverage-report/index.html`

Scapegoat report location: `<repo-home>/target/scala-2.12/scapegoat-report/scapegoat.html`

Scalastyle report location: `<repo-home>/target/scalastyle-result.xml`
